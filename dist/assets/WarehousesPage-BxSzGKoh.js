import{u as L,r,j as e,D as w,P as $,m as V,M as z,g as G,d as v,e as c,p as T,k as h,x as _,y as H,s as J}from"./index-0SUTSTHz.js";import{M as N}from"./Modal-D7o8EM96.js";import{D as K,a as C}from"./DropdownMenu-DJOgdqBT.js";const S=[{name:"Bleu",value:"blue",class:"bg-blue-500"},{name:"Vert",value:"emerald",class:"bg-emerald-500"},{name:"Violet",value:"purple",class:"bg-purple-500"},{name:"Orange",value:"orange",class:"bg-orange-500"},{name:"Rouge",value:"red",class:"bg-red-500"},{name:"Cyan",value:"cyan",class:"bg-cyan-500"},{name:"Indigo",value:"indigo",class:"bg-indigo-500"},{name:"Rose",value:"rose",class:"bg-rose-500"}],Z=()=>{const{hasPermission:g}=L(),[b,M]=r.useState([]),[D,y]=r.useState(!0),[f,d]=r.useState(null),[n,o]=r.useState([]),[E,x]=r.useState(!1),[I,u]=r.useState(!1),[a,i]=r.useState({}),[j,k]=r.useState(!1),p=async()=>{y(!0),d(null);try{const s=await G(v(c,"warehouses"));M(s.docs.map(t=>({id:t.id,...t.data()})))}catch{d("Impossible de charger les entrepôts.")}finally{y(!1)}};r.useEffect(()=>{p()},[]);const O=()=>{k(!1),i({name:"",location:"",isMain:!1,color:"blue"}),u(!0)},P=s=>{k(!0),i(s),u(!0)},m=()=>u(!1),A=async s=>{s.preventDefault();const{id:t,...l}=a;if(!l.name){d("Le nom est requis.");return}try{j?await _(h(c,"warehouses",t),l):await H(v(c,"warehouses"),l),await p(),m()}catch{d("Erreur d'enregistrement.")}},B=async s=>{if(window.confirm("Supprimer cet entrepôt ?"))try{await T(h(c,"warehouses",s)),await p()}catch{d("Erreur de suppression.")}},W=async()=>{const s=J(c);n.forEach(t=>s.delete(h(c,"warehouses",t))),await s.commit(),await p(),o([]),x(!1)},R=s=>{o(t=>t.includes(s)?t.filter(l=>l!==s):[...t,s])},q=s=>{s.target.checked?o(b.map(t=>t.id)):o([])},F=(s="blue")=>{const t=S.find(l=>l.value===s);return t?t.class:"bg-blue-500"};return e.jsxs("div",{className:"pb-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-gray-900 dark:text-white uppercase tracking-tight",children:"Gestion des Entrepôts"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Définissez vos lieux de stockage et leurs identités visuelles."})]}),g("warehouses")&&e.jsxs("div",{className:"flex items-center space-x-2",children:[n.length>0&&e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-xl hover:bg-red-700 font-bold uppercase text-xs transition-all shadow-lg active:scale-95",children:[e.jsx(w,{className:"w-5 h-5 mr-2"}),"Supprimer (",n.length,")"]}),e.jsxs("button",{onClick:O,className:"flex items-center px-6 py-3 bg-primary-600 text-white rounded-xl hover:bg-primary-700 font-black uppercase text-xs shadow-xl transition-all hover:scale-[1.02] active:scale-95",children:[e.jsx($,{className:"w-5 h-5 mr-2"}),"Ajouter un entrepôt"]})]})]}),D?e.jsx("div",{className:"p-24 text-center text-gray-400 font-black uppercase tracking-widest animate-pulse",children:"Chargement de la logistique..."}):f?e.jsx("p",{className:"text-red-500 font-bold text-center p-8 bg-red-50 rounded-2xl",children:f}):e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-2xl rounded-3xl border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-primary-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 w-10 text-center",children:e.jsx("input",{type:"checkbox",onChange:q,className:"h-4 w-4 text-primary-900 border-white rounded focus:ring-0 cursor-pointer"})}),e.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-white uppercase tracking-widest",children:"Identité / Couleur"}),e.jsx("th",{className:"px-6 py-4 text-left text-[10px] font-black text-white uppercase tracking-widest",children:"Emplacement"}),e.jsx("th",{className:"px-6 py-4 text-center text-[10px] font-black text-white uppercase tracking-widest",children:"Statut"}),e.jsx("th",{className:"px-6 py-4 text-right text-[10px] font-black text-white uppercase tracking-widest",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:b.map(s=>e.jsxs("tr",{className:n.includes(s.id)?"bg-primary-50 dark:bg-primary-900/10":"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("input",{type:"checkbox",checked:n.includes(s.id),onChange:()=>R(s.id),className:"h-4 w-4 text-primary-600 rounded cursor-pointer"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-3 h-10 rounded-full mr-4 ${F(s.color)} shadow-sm`}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-gray-900 dark:text-white uppercase tracking-tight",children:s.name}),e.jsxs("div",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:["Palette: ",s.color||"Défaut"]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 dark:text-gray-300 font-medium",children:s.location}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:s.isMain?e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 text-[10px] font-black uppercase rounded-full tracking-widest border border-green-200",children:"Principal"}):e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-400 text-[10px] font-black uppercase rounded-full tracking-widest",children:"Secondaire"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:g("warehouses")&&e.jsxs(K,{children:[e.jsxs(C,{onClick:()=>P(s),children:[e.jsx(V,{className:"w-4 h-4 mr-3"})," Modifier"]}),e.jsx("div",{className:"border-t dark:border-gray-700 my-1"}),e.jsxs(C,{onClick:()=>B(s.id),className:"text-red-600 font-bold",children:[e.jsx(w,{className:"w-4 h-4 mr-3"})," Supprimer"]})]})})]},s.id))})]})})}),e.jsx(N,{isOpen:I,onClose:m,title:j?"Configuration de l'entrepôt":"Nouvel entrepôt",maxWidth:"max-w-xl",children:e.jsxs("form",{onSubmit:A,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black uppercase text-gray-400 mb-1",children:"Nom du site"}),e.jsx("input",{type:"text",placeholder:"Ex: Entrepôt Nord",value:a.name||"",onChange:s=>i({...a,name:s.target.value}),className:"w-full border-2 rounded-xl p-3 dark:bg-gray-700 dark:border-gray-600 outline-none focus:border-primary-500 transition-all font-bold uppercase"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black uppercase text-gray-400 mb-1",children:"Emplacement géographique"}),e.jsx("input",{type:"text",placeholder:"Adresse complète...",value:a.location||"",onChange:s=>i({...a,location:s.target.value}),className:"w-full border-2 rounded-xl p-3 dark:bg-gray-700 dark:border-gray-600 outline-none focus:border-primary-500 transition-all font-medium"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-black uppercase text-gray-400 mb-3",children:"Palette de couleur (Identité visuelle)"}),e.jsx("div",{className:"grid grid-cols-4 gap-3",children:S.map(s=>e.jsx("button",{type:"button",onClick:()=>i({...a,color:s.value}),className:`relative h-12 rounded-xl border-2 transition-all flex items-center justify-center ${a.color===s.value?"border-gray-900 dark:border-white ring-2 ring-offset-2 ring-primary-500":"border-transparent hover:scale-105"} ${s.class}`,title:s.name,children:a.color===s.value&&e.jsx(z,{className:"w-5 h-5 text-white shadow-md"})},s.value))})]}),e.jsxs("div",{className:"flex items-center p-4 bg-gray-50 dark:bg-gray-900/50 rounded-2xl border border-dashed border-gray-200 dark:border-gray-600",children:[e.jsx("input",{type:"checkbox",id:"isMain",checked:a.isMain||!1,onChange:s=>i({...a,isMain:s.target.checked}),className:"w-6 h-6 text-primary-600 rounded-lg mr-3 cursor-pointer"}),e.jsx("label",{htmlFor:"isMain",className:"text-xs font-black uppercase text-gray-600 dark:text-gray-300 cursor-pointer",children:"Définir comme entrepôt principal de l'entreprise"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:m,className:"px-6 py-3 bg-gray-100 dark:bg-gray-700 rounded-xl font-bold text-xs uppercase tracking-widest",children:"Annuler"}),e.jsx("button",{type:"submit",className:"px-10 py-3 bg-primary-600 text-white rounded-xl font-black text-xs uppercase tracking-widest shadow-xl hover:bg-primary-700 active:scale-95 transition-all",children:"Enregistrer le site"})]})]})}),e.jsxs(N,{isOpen:E,onClose:()=>x(!1),title:"Confirmation de suppression",children:[e.jsx("div",{className:"p-6",children:e.jsxs("p",{className:"text-sm font-bold text-gray-600",children:["Supprimer définitivement les ",n.length," entrepôts sélectionnés ?"]})}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{onClick:W,className:"bg-red-600 text-white px-6 py-2 rounded-xl font-black text-xs uppercase tracking-widest shadow-lg hover:bg-red-700 ml-3",children:"Confirmer"}),e.jsx("button",{onClick:()=>x(!1),className:"px-6 py-2 bg-white text-gray-700 border rounded-xl font-black text-xs uppercase tracking-widest",children:"Annuler"})]})]})]})};export{Z as default};
