import{u as G,r as t,j as e,D as w,P as L,m as R,g as z,d as k,e as n,p as H,k as h,x as J,y as K,s as Q}from"./index-szRe9_7c.js";import{M as v}from"./Modal-BWnk_ifJ.js";import{D as T,a as S}from"./DropdownMenu-Cy-YUqPb.js";const Y=()=>{const{hasPermission:y}=G(),[g,C]=t.useState([]),[D,b]=t.useState(!0),[j,o]=t.useState(null),[r,l]=t.useState([]),[M,c]=t.useState(!1),[I,m]=t.useState(!1),[p,u]=t.useState({}),[f,N]=t.useState(!1),i=async()=>{b(!0);try{const s=await z(k(n,"brands"));C(s.docs.map(a=>({id:a.id,...a.data()})))}catch{o("Impossible de charger les marques.")}finally{b(!1)}};t.useEffect(()=>{i()},[]);const E=()=>{N(!1),u({name:""}),m(!0)},q=s=>{N(!0),u(s),m(!0)},x=()=>m(!1),A=async s=>{s.preventDefault();const{id:a,...d}=p;if(d.name)try{f?await J(h(n,"brands",a),d):await K(k(n,"brands"),d),await i(),x()}catch{o("Erreur d'enregistrement.")}},O=async s=>{if(window.confirm("Supprimer cette marque ?"))try{await H(h(n,"brands",s)),await i()}catch{o("Erreur de suppression.")}},B=async()=>{const s=Q(n);r.forEach(a=>s.delete(h(n,"brands",a))),await s.commit(),await i(),l([]),c(!1)},P=s=>{l(a=>a.includes(s)?a.filter(d=>d!==s):[...a,s])},F=s=>{s.target.checked?l(g.map(a=>a.id)):l([])};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Gestion des Marques"}),y("brands")&&e.jsxs("div",{className:"flex items-center space-x-2",children:[r.length>0&&e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:[e.jsx(w,{className:"w-5 h-5 mr-2"}),"Supprimer (",r.length,")"]}),e.jsxs("button",{onClick:E,className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700",children:[e.jsx(L,{className:"w-5 h-5 mr-2"}),"Ajouter une marque"]})]})]}),D?e.jsx("p",{children:"Chargement..."}):j?e.jsx("p",{className:"text-red-500",children:j}):e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-primary-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",onChange:F,className:"h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-bold text-white uppercase",children:"Nom"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-bold text-white uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:g.map(s=>e.jsxs("tr",{className:r.includes(s.id)?"bg-primary-50 dark:bg-gray-700/50":"",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:r.includes(s.id),onChange:()=>P(s.id),className:"h-4 w-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"})}),e.jsx("td",{className:"px-6 py-4",children:s.name}),e.jsx("td",{className:"px-6 py-4 text-right",children:y("brands")&&e.jsxs(T,{children:[e.jsxs(S,{onClick:()=>q(s),children:[e.jsx(R,{className:"w-4 h-4 mr-3"})," Modifier"]}),e.jsxs(S,{onClick:()=>O(s.id),className:"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300",children:[e.jsx(w,{className:"w-4 h-4 mr-3"})," Supprimer"]})]})})]},s.id))})]})}),e.jsx(v,{isOpen:I,onClose:x,title:f?"Modifier la marque":"Ajouter une marque",children:e.jsxs("form",{onSubmit:A,className:"p-6 space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Nom de la marque",value:p.name||"",onChange:s=>u({...p,name:s.target.value}),className:"w-full border rounded p-2 dark:bg-gray-700"}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 bg-gray-200 rounded-md",children:"Annuler"}),e.jsx("button",{type:"submit",className:"bg-primary-600 text-white px-4 py-2 rounded",children:"Sauvegarder"})]})]})}),e.jsxs(v,{isOpen:M,onClose:()=>c(!1),title:"Confirmer la suppression",children:[e.jsx("div",{className:"p-6",children:e.jsxs("p",{children:["Êtes-vous sûr de vouloir supprimer les ",r.length," marques sélectionnées ?"]})}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsx("button",{onClick:B,className:"bg-red-600 text-white px-4 py-2 rounded",children:"Supprimer"}),e.jsx("button",{onClick:()=>c(!1),className:"ml-2 px-4 py-2 bg-gray-200 rounded",children:"Annuler"})]})]})]})};export{Y as default};
